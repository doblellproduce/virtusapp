{
  "rules": {
    // Users can only read/update their own profile.
    "users": {
      "$uid": {
        "read": "request.auth.uid == $uid || get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']",
        "update": "request.auth.uid == $uid",
        "create": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'Admin'",
        "delete": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'Admin'"
      }
    },
    // Vehicles are public to read, but only specific roles can modify them.
    "vehicles": {
      "$vehicleId": {
        "read": "true", // Publicly readable
        "write": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']"
      }
    },
     // Reservations can be read by admins/supervisors. Users can create them.
    "reservations": {
      "$reservationId": {
        "read": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']",
        "create": "request.auth != null", // Any authenticated user can start a reservation
        "update": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']"
      }
    },
    // Invoices are admin/supervisor only
    "invoices": {
      "$invoiceId": {
        "read": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']",
        "write": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']"
      }
    },
     // Documents are admin/supervisor only, except for creation by auth'd user
    "documents": {
       "$docId": {
        "read": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']",
        "write": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']"
       }
    },
     // Expenses are admin/supervisor only
    "expenses": {
       "$expenseId": {
         "read": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']",
        "write": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']"
       }
    },
     // Contracts are admin/supervisor only
    "contracts": {
       "$contractId": {
         "read": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']",
        "write": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']"
       }
    },
     // Maintenance logs are admin/supervisor only
    "maintenanceLogs": {
       "$logId": {
         "read": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']",
        "write": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ['Admin', 'Supervisor']"
       }
    },
    // Activity logs are admin/supervisor only
    "activityLogs": {
        "$logId": {
            "read": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'Admin'",
            "write": "get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'Admin'"
        }
    }
  }
}